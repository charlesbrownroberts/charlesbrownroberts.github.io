<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Display a map</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }

        .marker {
            background-image: url('/maps/icons/marker-15.svg');
            background-size: cover;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
        }

        .mapboxgl-popup {
            max-width: 200px;
        }

        .mapboxgl-popup-content {
            text-align: center;
            font-family: 'Open Sans', sans-serif;
        }

        .distance-container {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1;
        }

        .distance-container > * {
            background-color: rgba(0, 0, 0, 0.5);
            color: #fff;
            font-size: 11px;
            line-height: 18px;
            display: block;
            margin: 0;
            padding: 5px 10px;
            border-radius: 3px;
        }

    </style>
</head>
<body>

<div id='map'></div>
<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiY2FsaWZvcm5pYXZvbCIsImEiOiJjanoxOXBzamcwY3RiM29zMHZyeXZ2MmxyIn0.HAO3xS15kovloVAwCEGMiw';
    var map = new mapboxgl.Map({
        container: 'map', // container id
        style: 'mapbox://styles/californiavol/cjz19qt7t02l91cqosp0jbbgx', // stylesheet location
        //center: [2.347,48.859], // starting position [lng, lat]
        center: [2.310189, 48.852675], // starting position [lng, lat]
        zoom: 13 // starting zoom
    });

    // Add geolocate control to the map.
    map.addControl(new mapboxgl.GeolocateControl({
        positionOptions: {
            enableHighAccuracy: true
        },
        trackUserLocation: true
    }));

    // Add zoom and rotation controls to the map.
    map.addControl(new mapboxgl.NavigationControl());


    var distanceContainer = document.getElementById('distance');

    // Used to draw a line between points
    var linestring = {
        "type": "Feature",
        "geometry": {
            "type": "LineString",
            "coordinates": []
        }
    };

    var size = 200;

    var pulsingDot = {
        width: size,
        height: size,
        data: new Uint8Array(size * size * 4),

        onAdd: function() {
            var canvas = document.createElement('canvas');
            canvas.width = this.width;
            canvas.height = this.height;
            this.context = canvas.getContext('2d');
        },

        render: function() {
            var duration = 1000;
            var t = (performance.now() % duration) / duration;

            var radius = size / 2 * 0.3;
            var outerRadius = size / 2 * 0.7 * t + radius;
            var context = this.context;

// draw outer circle
            context.clearRect(0, 0, this.width, this.height);
            context.beginPath();
            context.arc(this.width / 2, this.height / 2, outerRadius, 0, Math.PI * 2);
            context.fillStyle = 'rgba(255, 200, 200,' + (1 - t) + ')';
            context.fill();

// draw inner circle
            context.beginPath();
            context.arc(this.width / 2, this.height / 2, radius, 0, Math.PI * 2);
            context.fillStyle = 'rgba(255, 100, 100, 1)';
            context.strokeStyle = 'white';
            context.lineWidth = 2 + 4 * (1 - t);
            context.fill();
            context.stroke();

// update this image's data with data from the canvas
            this.data = context.getImageData(0, 0, this.width, this.height).data;

// keep the map repainting
            map.triggerRepaint();

// return `true` to let the map know that the image was updated
            return true;
        }
    };

    // map.on('load', function () {
    //
    //     map.addImage('pulsing-dot', pulsingDot, { pixelRatio: 2 });
    //
    //     map.addLayer({
    //         "id": "points",
    //         "type": "symbol",
    //         "source": {
    //             "type": "geojson",
    //             "data": {
    //                 "type": "FeatureCollection",
    //                 "features": [{
    //                     "type": "Feature",
    //                     "geometry": {
    //                         "type": "Point",
    //                         "coordinates": [2.310189, 48.852675]
    //                     }
    //                 }]
    //             }
    //         },
    //         "layout": {
    //             "icon-image": "pulsing-dot"
    //         }
    //     });
    //
    //
    //
    // });


    var geojson ={
        "type": "FeatureCollection",
        "features": [
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.29502750000006,
                        48.8737917,
                        0
                    ]
                },
                "properties": {
                    "name": "Arc de Triomphe",
                    "styleUrl": "#icon-1535-880E4F-nodesc",
                    "styleHash": "2949923c",
                    "styleMapHash": {
                        "normal": "#icon-1535-880E4F-nodesc-normal",
                        "highlight": "#icon-1535-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.33585830000004,
                        48.8610135,
                        0
                    ]
                },
                "properties": {
                    "name": "Louvre Pyramid",
                    "styleUrl": "#icon-1535-880E4F-nodesc",
                    "styleHash": "2949923c",
                    "styleMapHash": {
                        "normal": "#icon-1535-880E4F-nodesc-normal",
                        "highlight": "#icon-1535-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.31019930000002,
                        48.8524563,
                        0
                    ]
                },
                "properties": {
                    "name": "14 Rue Bixio",
                    "styleUrl": "#icon-1603-A52714-nodesc",
                    "styleHash": "f207dd4",
                    "styleMapHash": {
                        "normal": "#icon-1603-A52714-nodesc-normal",
                        "highlight": "#icon-1603-A52714-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.34729240000001,
                        48.8515045,
                        0
                    ]
                },
                "properties": {
                    "name": "Rue Galande",
                    "styleUrl": "#icon-1596-880E4F",
                    "styleHash": "-6ec26472",
                    "styleMapHash": {
                        "normal": "#icon-1596-880E4F-normal",
                        "highlight": "#icon-1596-880E4F-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png",
                    "description": "Cute Street<br>Closest metro - Saint-Michel Notre Dame or Cluny-La Sorbonn"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.31149970000001,
                        48.8599542,
                        0
                    ]
                },
                "properties": {
                    "name": "Rue Saint-Dominique",
                    "styleUrl": "#icon-1596-880E4F",
                    "styleHash": "-6ec26472",
                    "styleMapHash": {
                        "normal": "#icon-1596-880E4F-normal",
                        "highlight": "#icon-1596-880E4F-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png",
                    "description": "Eiffel tower views and pastries and cheese shops<br>Closest metro: La Tour-Maubourg  - one block "
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.3482649,
                        48.8498275,
                        0
                    ]
                },
                "properties": {
                    "name": "La Maison d'Isabelle best croissants",
                    "styleUrl": "#icon-1577-880E4F",
                    "styleHash": "-1b4d102f",
                    "styleMapHash": {
                        "normal": "#icon-1577-880E4F-normal",
                        "highlight": "#icon-1577-880E4F-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png",
                    "description": "La Maison d'Isabelle<br>47ter Boulevard Saint-Germain<br>Best crossiants in paris"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.30274880000002,
                        48.842258,
                        0
                    ]
                },
                "properties": {
                    "name": "Maison Pichard 2nd best croissants",
                    "styleUrl": "#icon-1577-880E4F",
                    "styleHash": "-1b4d102f",
                    "styleMapHash": {
                        "normal": "#icon-1577-880E4F-normal",
                        "highlight": "#icon-1577-880E4F-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png",
                    "description": "Maison Pichard<br>88 Rue Cambronne<br>2nd best croissants"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.31466499999999,
                        48.8412273,
                        0
                    ]
                },
                "properties": {
                    "name": "Des Gateaux et du Pain 3rd croissants 63 Boulevard Pasteur",
                    "styleUrl": "#icon-1577-880E4F-nodesc",
                    "styleHash": "-12222746",
                    "styleMapHash": {
                        "normal": "#icon-1577-880E4F-nodesc-normal",
                        "highlight": "#icon-1577-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.33194730000002,
                        48.8640803,
                        0
                    ]
                },
                "properties": {
                    "name": "Sébastien Gaudard\n - 5th croissants 1 Rue des Pyramides",
                    "styleUrl": "#icon-1577-880E4F-nodesc",
                    "styleHash": "-12222746",
                    "styleMapHash": {
                        "normal": "#icon-1577-880E4F-nodesc-normal",
                        "highlight": "#icon-1577-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.3816319,
                        48.8665782,
                        0
                    ]
                },
                "properties": {
                    "name": "Le Grenier à Pain - best baguette 152 Rue Oberkampf",
                    "styleUrl": "#icon-1577-880E4F-nodesc",
                    "styleHash": "-12222746",
                    "styleMapHash": {
                        "normal": "#icon-1577-880E4F-nodesc-normal",
                        "highlight": "#icon-1577-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.32898929999999,
                        48.8512921,
                        0
                    ]
                },
                "properties": {
                    "name": "Poilâne - 2nd bakery - 8 Rue du Cherche-Midi",
                    "styleUrl": "#icon-1577-880E4F-nodesc",
                    "styleHash": "-12222746",
                    "styleMapHash": {
                        "normal": "#icon-1577-880E4F-nodesc-normal",
                        "highlight": "#icon-1577-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        0.122289000000023,
                        49.495182,
                        0
                    ]
                },
                "properties": {
                    "name": "Pain d'Epis - 3rd bakery ",
                    "styleUrl": "#icon-1577-880E4F-nodesc",
                    "styleHash": "-12222746",
                    "styleMapHash": {
                        "normal": "#icon-1577-880E4F-nodesc-normal",
                        "highlight": "#icon-1577-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.30858060000003,
                        48.8598589,
                        0
                    ]
                },
                "properties": {
                    "name": "Le Moulin de la Vierge - 4th bakery",
                    "styleUrl": "#icon-1577-880E4F-nodesc",
                    "styleHash": "-12222746",
                    "styleMapHash": {
                        "normal": "#icon-1577-880E4F-nodesc-normal",
                        "highlight": "#icon-1577-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.30584690000001,
                        48.8610608,
                        0
                    ]
                },
                "properties": {
                    "name": "Chocolate Maestro #3: Michel Chaudun - 149 Rue de l'Université",
                    "styleUrl": "#icon-1577-880E4F-nodesc",
                    "styleHash": "-12222746",
                    "styleMapHash": {
                        "normal": "#icon-1577-880E4F-nodesc-normal",
                        "highlight": "#icon-1577-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            },
            {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        2.36027779999995,
                        48.7622322,
                        0
                    ]
                },
                "properties": {
                    "name": "Rungis Market Rue de la Tour",
                    "styleUrl": "#icon-1685-880E4F-nodesc",
                    "styleHash": "-774bfd68",
                    "styleMapHash": {
                        "normal": "#icon-1685-880E4F-nodesc-normal",
                        "highlight": "#icon-1685-880E4F-nodesc-highlight"
                    },
                    "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
                }
            }
        ]
    };


    // map.on('load', function () {
    //
    //     map.addLayer({
    //         "id": "points",
    //         "type": "symbol",
    //         "source": {
    //             "type": "geojson",
    //             "data": {
    //                 "type": "FeatureCollection",
    //                 "features": [
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.29502750000006,
    //                                 48.8737917,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Arc de Triomphe",
    //                             "styleUrl": "#icon-1535-880E4F-nodesc",
    //                             "styleHash": "2949923c",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1535-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1535-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.33585830000004,
    //                                 48.8610135,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Louvre Pyramid",
    //                             "styleUrl": "#icon-1535-880E4F-nodesc",
    //                             "styleHash": "2949923c",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1535-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1535-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.31019930000002,
    //                                 48.8524563,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "14 Rue Bixio",
    //                             "styleUrl": "#icon-1603-A52714-nodesc",
    //                             "styleHash": "f207dd4",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1603-A52714-nodesc-normal",
    //                                 "highlight": "#icon-1603-A52714-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.34729240000001,
    //                                 48.8515045,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Rue Galande",
    //                             "styleUrl": "#icon-1596-880E4F",
    //                             "styleHash": "-6ec26472",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1596-880E4F-normal",
    //                                 "highlight": "#icon-1596-880E4F-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png",
    //                             "description": "Cute Street<br>Closest metro - Saint-Michel Notre Dame or Cluny-La Sorbonn"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.31149970000001,
    //                                 48.8599542,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Rue Saint-Dominique",
    //                             "styleUrl": "#icon-1596-880E4F",
    //                             "styleHash": "-6ec26472",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1596-880E4F-normal",
    //                                 "highlight": "#icon-1596-880E4F-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png",
    //                             "description": "Eiffel tower views and pastries and cheese shops<br>Closest metro: La Tour-Maubourg  - one block "
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.3482649,
    //                                 48.8498275,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "La Maison d'Isabelle best croissants",
    //                             "styleUrl": "#icon-1577-880E4F",
    //                             "styleHash": "-1b4d102f",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1577-880E4F-normal",
    //                                 "highlight": "#icon-1577-880E4F-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png",
    //                             "description": "La Maison d'Isabelle<br>47ter Boulevard Saint-Germain<br>Best crossiants in paris"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.30274880000002,
    //                                 48.842258,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Maison Pichard 2nd best croissants",
    //                             "styleUrl": "#icon-1577-880E4F",
    //                             "styleHash": "-1b4d102f",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1577-880E4F-normal",
    //                                 "highlight": "#icon-1577-880E4F-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png",
    //                             "description": "Maison Pichard<br>88 Rue Cambronne<br>2nd best croissants"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.31466499999999,
    //                                 48.8412273,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Des Gateaux et du Pain 3rd croissants 63 Boulevard Pasteur",
    //                             "styleUrl": "#icon-1577-880E4F-nodesc",
    //                             "styleHash": "-12222746",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1577-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1577-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.33194730000002,
    //                                 48.8640803,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Sébastien Gaudard\n - 5th croissants 1 Rue des Pyramides",
    //                             "styleUrl": "#icon-1577-880E4F-nodesc",
    //                             "styleHash": "-12222746",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1577-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1577-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.3816319,
    //                                 48.8665782,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Le Grenier à Pain - best baguette 152 Rue Oberkampf",
    //                             "styleUrl": "#icon-1577-880E4F-nodesc",
    //                             "styleHash": "-12222746",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1577-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1577-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.32898929999999,
    //                                 48.8512921,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Poilâne - 2nd bakery - 8 Rue du Cherche-Midi",
    //                             "styleUrl": "#icon-1577-880E4F-nodesc",
    //                             "styleHash": "-12222746",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1577-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1577-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 0.122289000000023,
    //                                 49.495182,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Pain d'Epis - 3rd bakery ",
    //                             "styleUrl": "#icon-1577-880E4F-nodesc",
    //                             "styleHash": "-12222746",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1577-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1577-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.30858060000003,
    //                                 48.8598589,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Le Moulin de la Vierge - 4th bakery",
    //                             "styleUrl": "#icon-1577-880E4F-nodesc",
    //                             "styleHash": "-12222746",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1577-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1577-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.30584690000001,
    //                                 48.8610608,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Chocolate Maestro #3: Michel Chaudun - 149 Rue de l'Université",
    //                             "styleUrl": "#icon-1577-880E4F-nodesc",
    //                             "styleHash": "-12222746",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1577-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1577-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     },
    //                     {
    //                         "type": "Feature",
    //                         "geometry": {
    //                             "type": "Point",
    //                             "coordinates": [
    //                                 2.36027779999995,
    //                                 48.7622322,
    //                                 0
    //                             ]
    //                         },
    //                         "properties": {
    //                             "name": "Rungis Market Rue de la Tour",
    //                             "styleUrl": "#icon-1685-880E4F-nodesc",
    //                             "styleHash": "-774bfd68",
    //                             "styleMapHash": {
    //                                 "normal": "#icon-1685-880E4F-nodesc-normal",
    //                                 "highlight": "#icon-1685-880E4F-nodesc-highlight"
    //                             },
    //                             "icon": "http://www.gstatic.com/mapspro/images/stock/503-wht-blank_maps.png"
    //                         }
    //                     }
    //                 ]
    //             }
    //         },
    //         "layout": {
    //             "icon-image": "{icon}-15",
    //             "text-field": "{title}",
    //             "text-font": ["Open Sans Semibold", "Arial Unicode MS Bold"],
    //             "text-offset": [0, 0.6],
    //             "text-anchor": "top"
    //         }
    //     });
    // });


    map.on('load', function() {
        map.addSource('geojson', {
            "type": "geojson",
            "data": geojson
        });

// Add styles to the map
        map.addLayer({
            id: 'measure-points',
            type: 'circle',
            source: 'geojson',
            paint: {
                'circle-radius': 5,
                'circle-color': '#000'
            },
            filter: ['in', '$type', 'Point']
        });
        map.addLayer({
            id: 'measure-lines',
            type: 'line',
            source: 'geojson',
            layout: {
                'line-cap': 'round',
                'line-join': 'round'
            },
            paint: {
                'line-color': '#000',
                'line-width': 2.5
            },
            filter: ['in', '$type', 'LineString']
        });

        map.on('click', function(e) {
            var features = map.queryRenderedFeatures(e.point, { layers: ['measure-points'] });

// Remove the linestring from the group
// So we can redraw it based on the points collection
            if (geojson.features.length > 1) geojson.features.pop();

// Clear the Distance container to populate it with a new value
            distanceContainer.innerHTML = '';

// If a feature was clicked, remove it from the map
            if (features.length) {
                var id = features[0].properties.id;
                geojson.features = geojson.features.filter(function(point) {
                    return point.properties.id !== id;
                });
            } else {
                var point = {
                    "type": "Feature",
                    "geometry": {
                        "type": "Point",
                        "coordinates": [
                            e.lngLat.lng,
                            e.lngLat.lat
                        ]
                    },
                    "properties": {
                        "id": String(new Date().getTime())
                    }
                };

                geojson.features.push(point);
            }

            if (geojson.features.length > 1) {
                linestring.geometry.coordinates = geojson.features.map(function(point) {
                    return point.geometry.coordinates;
                });

                geojson.features.push(linestring);

// Populate the distanceContainer with total distance
                var value = document.createElement('pre');
                value.textContent = 'Total distance: ' + turf.lineDistance(linestring).toLocaleString() + 'km';
                distanceContainer.appendChild(value);
            }

            map.getSource('geojson').setData(geojson);
        });
    });

    map.on('mousemove', function (e) {
        var features = map.queryRenderedFeatures(e.point, { layers: ['measure-points'] });
// UI indicator for clicking/hovering a point on the map
        map.getCanvas().style.cursor = (features.length) ? 'pointer' : 'crosshair';
    });


    // add markers to map
    // geojson.features.forEach(function(marker) {
    //
    //     // create a HTML element for each feature
    //     var el = document.createElement('div');
    //     el.className = 'marker';
    //
    //     // make a marker for each feature and add to the map
    //     new mapboxgl.Marker(el)
    //         .setLngLat(marker.geometry.coordinates)
    //         .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
    //             .setHTML('<h3>' + marker.properties.name + '</h3>' + '<p>' + marker.properties.description + '</p>'))
    //         .addTo(map);
    // });


</script>

</body>
</html>